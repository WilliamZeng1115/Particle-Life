<!DOCTYPE html>
<html>
<head>
<title>Particle Life</title>
</style>
</head>

<body>
<canvas class='myCanvas' onclick="updateMouse(event)">
</canvas>

<style>
  body {
    margin: 0;
    overflow: hidden;
  }
</style>

<script>
var canvas = document.querySelector('.myCanvas');
var ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

var radius = 5;
var particles = [];
class particle {

  constructor(type, x, y) {
    var canvas = document.querySelector('.myCanvas');
    this.ctx = canvas.getContext('2d');
    this.type = type;
    this.x = x;
    this.y = y;

    switch(type){
      case 0:
        this.color = 'rgb(255, 100, 100)'
        break;
      case 1:
        this.color = 'rgb(100, 255, 100)'
        break;
      case 2:
        this.color = 'rgb(100, 100, 255)'
        break;
      default:
        this.color = 'rgb(255, 255, 255)'
        break;
      }
    this.ctx.fillStyle = this.color;

    this.velocityx = (Math.random() - 0.5);
    this.velocityy = (Math.random() - 0.5);
  }

  renderImage() {
    this.ctx.beginPath();
    this.ctx.arc(this.x, this.y, radius, 0, 2 * Math.PI);
    this.ctx.fillStyle = this.color;
    this.ctx.fill();
  }

  collisionCheck(){
    for(var i = 0; i < particles.length; i++){
      if(!(particles[i] == this) && (Math.sqrt((this.x - particles[i].x)**2 + (this.y - particles[i].y)**2) < 10)){
        this.velocityx *= -1;
        this.velocityy *= -1;
      }
    }
  }

  move() {
    this.renderImage();
    this.collisionCheck();

    this.x += this.velocityx;
    this.y += this.velocityy;
  }
}

function updateMouse(event) {
  var particleBase = new particle(Math.floor(Math.random()*4), event.clientX,  event.clientY);
  particles.push(particleBase);
  particleBase.renderImage();
}

function loop(){
  const context = canvas.getContext('2d');
  context.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = 'rgb(0, 0, 0)';
  ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);
  particles.forEach(function(element) {
    element.move();
  });
  requestAnimationFrame(loop);
}

loop();

</script>
</body>
</html>
